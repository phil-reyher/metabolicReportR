---
output: 
  pdf_document:
    keep_tex: true
    includes:
      in_header: header.tex
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
load(file = ".RData") 
library(kableExtra)
library(tidyverse) 
library(magrittr)

options(knitr.table.format = "latex")

```

\begin{center}
\textbf{\large \textbf{La Trobe Performance Hub} }
\end{center}
\vspace{2em}
\begin{tabularx}{\textwidth}{r c}
\textbf{Athlete Name:} & `r dem$NAME`\\
\textbf{Date of Birth:} & `r format(dem$TEST_DAT, format = "%d-%b-%Y")`\\
\textbf{Sport:} & \\
\end{tabularx}

\fancysection{Test Details}

\fancysection{Anthropometry Data}

\fancysection{Summary Data}
```{r, echo=FALSE}
cp %>% select(THRESHOLD,VO2:HRPERC) %>%
  kbl( booktabs = T, escape = FALSE,digits = 1,align = "c",
       col.names= c("Threshold","VO\\textsubscript{2} \\par (mL/kg/min)",
                   "Power \\par (W)","Heart Rate \\par (beats/min)",
                   "VO\\textsubscript{2} \\par (\\%)","Power \\par (\\%)",
                   "Heart Rate \\par (\\%)" ) ) %>% 
  kable_styling(latex_options = c("HOLD_position")) %>% 
  column_spec(1:7,width = "\\\\dimexpr\\\\textwidth/7\\\\relax") %>% 
  column_spec(1,latex_column_spec =">{\\\\raggedright\\\\arraybackslash}p{\\\\dimexpr\\\\textwidth/7\\\\relax}" )
```
\fancysection{GXT Data}
```{r, echo=FALSE}
gxt %>%
  kbl( booktabs = T, escape = FALSE,digits = 1, align = "c",
       col.names = c("Power \\par (W)","VO\\textsubscript{2} \\par (mL/kg/min)",
                     "Heart Rate \\par (beats/min)","VO\\textsubscript{2max} \\par (\\%)",
                 "HR\\textsubscript{max} \\par (\\%)") ) %>% 
  column_spec(1:5, width = "\\\\dimexpr\\\\textwidth/5\\\\relax") %>% 
  row_spec(which(gxt$WORK %in% cp$WORK),bold = T) %>% 
    kable_styling(latex_options=c("striped","HOLD_position"))


```
\newpage
\fancysection{Training Zones Modified Allen \& Coggan}
```{r,echo=F}
zone %>% 
  kbl( booktabs = T, escape = FALSE,digits = 1, align = "c") %>% 
  add_header_above(c(" "=2, "Power Zones" = 2, "Heart Rate Zones" = 2)) %>%
  kable_styling(latex_options=c("HOLD_position","striped")) %>% 
  column_spec(1:6, width = "\\\\dimexpr\\\\textwidth/6\\\\relax") 
```



