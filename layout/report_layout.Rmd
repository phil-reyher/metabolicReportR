---
output: 
  pdf_document:
    keep_tex: true
    includes:
      in_header: additional_latex_styling.tex
---
```{r setup, include=FALSE}
load(file = ".RData") 
library(kableExtra)
library(tidytable)
options(knitr.table.format = "latex")

knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE,
	error = FALSE
)

```

\begin{center}
\textbf{\large \textbf{La Trobe Performance Hub} }
\end{center}
\vspace{2em}
\begingroup
\setlength{\tabcolsep}{0.5em}
\begin{tabularx}{\textwidth}{r l}
\textbf{Athlete Name:} & `r dem$NAME`\\
\textbf{Age:} & `r dem$AGE`\\
\textbf{Sport:} & \\
\end{tabularx}
\endgroup

\vspace{10ex}

\fancysection{Test Details}
```{r}
details %>% 
    mutate(across(2:4,~round(as.numeric(.),1) )) %>% 
  mutate(across(everything(),as.character)) %>% 
  mutate(across(everything(),~paste("\\raisebox{-1pt}{", ., "}")) ) %>% 
    kbl( booktabs = T, escape = FALSE,align = "c",
       col.names= c("Date of Test","Temperature (Â° C)","Humidity (\\%)","Pressure (mmHg)") ) %>% 
  kable_styling(latex_options = c("HOLD_position")) %>% 
  column_spec(1:4,width = "\\\\dimexpr\\\\textwidth/4\\\\relax") %>% 
    row_spec(1, background="#fff3f3")



```


\fancysection{Summary Data}
```{r}
cp %>% select(VARIABLE,VO2ABS:HRPERC) %>% 
  mutate(across(where(is.numeric),~round(.,1))) %>% 
  mutate(across(everything(),as.character)) %>% 
  mutate(across(everything(),~paste("\\raisebox{-1pt}{", ., "}")) ) %>% 
  kbl( booktabs = T, escape = FALSE,align = "c",
       col.names= c("Variable","VO\\textsubscript{2} \\par (L/min)",
                    "VO\\textsubscript{2} \\par (mL/kg/min)",
                   "Power \\par (W)","Heart Rate \\par (beats/min)",
                   "VO\\textsubscript{2} \\par (\\%)","Power \\par (\\%)",
                   "Heart Rate \\par (\\%)" ) ) %>% 
  kable_styling(latex_options = c("HOLD_position")) %>% 
  row_spec(seq(1,nrow(cp),2), background="#fff3f3") %>% 
  column_spec(2:8,width = "\\\\dimexpr0.95\\\\textwidth/8\\\\relax") %>% 
  column_spec(1,width = "\\\\dimexpr1.35\\\\textwidth/8\\\\relax")
```
\fancysection{GXT Data}
```{r}
gxt %>%
    mutate(across(where(is.numeric),~round(.,1))) %>% 
  mutate(across(everything(),as.character)) %>% 
  mutate(across(everything(),~paste("\\raisebox{-1pt}{", ., "}")) ) %>% 
  kbl( booktabs = T, escape = FALSE,digits = 1, align = "c",linesep = "",
       col.names = c("Power \\par (W)","VO\\textsubscript{2} \\par (mL/kg/min)",
                     "Heart Rate \\par (beats/min)","VO\\textsubscript{2max} \\par (\\%)",
                 "HR\\textsubscript{max} \\par (\\%)") ) %>% 
  column_spec(1:5, width = "\\\\dimexpr\\\\textwidth/5\\\\relax") %>% 
  row_spec(seq(1,nrow(gxt),2), background="#fff3f3") %>% 
  row_spec(which(gxt$WORK %in% cp$WORK[2:3]),bold = T,background = "#ee3124",color="white") %>% 
    kable_styling(latex_options=c("HOLD_position")) %>% 
  footnote(number = "Stages at which VT1 and VT2 occured are marked in red.")


```
\newpage
\fancysection{Training Zones Modified Allen \& Coggan}
```{r}
coln <- colnames(zone)
zone %>% 
  tidytable::mutate(across(.cols = everything(),as.character)) %>% 
  tidytable::mutate(across(everything(),~paste("\\raisebox{-1pt}{", ., "}")) ) %>% 
  `colnames<-`(coln) %>% 
  kbl( booktabs = T, escape = FALSE,digits = 1, align = "c") %>% 
  add_header_above(c(" "=2, "Power Zones" = 2, "Heart Rate Zones" = 2)) %>%
  kable_styling(latex_options=c("HOLD_position")) %>% 
  column_spec(1:6, width = "\\\\dimexpr\\\\textwidth/6\\\\relax") %>% 
  row_spec(seq(1,nrow(zone),2), background="#fff3f3")
```



